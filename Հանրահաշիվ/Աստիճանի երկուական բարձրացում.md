---
title: Աստիճանի երկուական բարձրացում
tags:
  - հանրահաշիվ
  - թվի-աստիճան
  - երկուական-համակարգ
difficulty: "?"
ioi-freq: "?"
oi-freq: "?"
contributors:
  - <a class="ctrb-a" href="https://codeforces.com/profile/erankyun">Համլետ Պետրոսյան</a>
---

Աստիճանի երկուական բարձրացումը (անգլերեն՝ binary exponentiation) հնարք է, որը թույլ է տալիս հաշվել $a$ թվի $a^n$ աստիճանը $O(\log n)$ բազմապատկումներ օգտագործելով (ի տարբերություն $O(n)$ բազմապատկում օգտագործող հասարակ տարբերակի)։

Նաև այս հնարքը օգտագործվում է բազմաթիվ այլ հանրահաշվական խնդիրներում, քանի որ այն կիրառելի է ցանկացած գործողությունների դեպքում, որոնք օժտված են **ասոցիատիվ (զուգորդական)** հատկությամբ․ $$X \circ (Y \circ Z) = (X \circ Y) \circ Z$$որտեղ $\circ$ -ով է նշանակված գործողության պայմանական նշանը։ Նմանատիպ գործողություններ են մնացորդով բազմապատկումը, մատրիցների բազմապատկումը և այլն։

## Ալգորիթմ

Աստիճանի բարձրացման «միամիտ» ալգորիթմը կատարում է $a$ թվով բազմապատկում $n - 1$ անգամ $a^n = a \cdot a \cdot\ ...\ \cdot a$ թիվը ստանալու համար, ինչը կիրառելի չէ մեծ $n$-երի դեպքում։ 

Հայտնի է, որ $a^{b + c} = a^b \cdot a^c$։ Հետևաբար $a^{2b} = a^b \cdot a^b = (a^b)^2$: Ներկայացվող ալգորիթմի հիմնական գաղափարը այս հատկությունն օգտագործելով աշխատանքի բաժանումն է։ Ներկայացնենք $n$-ը երկուական համակարգում․ օրինակ՝ $$3^{13} = 3^{1101_2} = 3^{1000_2} \cdot 3^{100_2} \cdot 3^{1_2} = 3^8 \cdot 3^4 \cdot 3^1$$
Հայտնի է, որ $n$-ը ունի ուղիղ $\lfloor \log_2 n \rfloor + 1$ թվանշաններ երկուական համակարգում։ Հետևում է, որ անհրաժեշտ է կատարել ընդամենը $O(\log n)$ բազմապատկում՝ օգտագործելով $a^1, a^2, a^4, ..., a^{2^{\lfloor \log n \rfloor}}$ աստիճանները։ Մնում է հաշվել այս աստիճանները։ Նկատենք, որ տրված հաջարդականության մեջ յուրաքանչյուրը իր նախորդի քառակուսին է․ օրինակ՝$$\begin{align}
3^1 &= 3 \\
3^2 &= \left(3^1\right)^2 = 3^2 = 9 \\
3^4 &= \left(3^2\right)^2 = 9^2 = 81 \\
3^8 &= \left(3^4\right)^2 = 81^2 = 6561
\end{align}$$ Այսինքն $3^{13}$-ի վերջնական պատասխանը ստանալու համար պետք է բազմապատկել այս թվերից երեքը (բաց թողնելով $3^2$-ը քանի որ $n=13$-ում համապատասխան բիթը $0$ է)․ $3^{13} = 6561 \cdot 81 \cdot 3 = 1594323$:

Վերջնական ալգորիթմի բարդությունը $O(\log n)$ է, քանի որ հաշվում ենք $\log n$ հատ $a$-ի աստիճաններ, և կատարում ամենաշատը $\log n$ բազմապատկում։

Նույն մտքից հետևում է հետևյալ ռեկուրսիվ ներկայացումը․ $$a^n = \begin{cases}
1 &\text{եթե } n = 0, \\
\left(a^{\frac{n}{2}}\right)^2 &\text{եթե } n > 0 \text{ և } n \text{-ը զույգ է},\\
\left(a^{\frac{n - 1}{2}}\right)^2 \cdot a &\text{եթե } n > 0 \text{ և } n \text{-ը կենտ է։}\\
\end{cases}$$

## Իրականացում

Ռեկուրսիվ ներկայացման ուղղակի գրառումը․
```cpp
long long binpow(long long a, long long b) {
    if (b == 0)
        return 1;
    long long res = binpow(a, b / 2);
    if (b % 2)
        return res * res * a;
    else
        return res * res;
}
```

Ստորև ներկայացված տարբերակը կատարում է նույնը առանց ռեկուրսիվ կանչերի։ Թվի աստիճանները հաշվարկվում են ցիկլի մեջ և բազմապատկվում պատասխանին։ Չնայած երկու տարբերակների բարդությունները նույնն են, երկրորդ տարբերակը կիրառելիս չնչին արագ է ռեկուրսիվ կանչեր չօգտագործելու շնորհիվ։
```cpp
long long binpow(long long a, long long b) {
    long long res = 1;
    while (b > 0) {
        if (b & 1)
            res = res * a;
        a = a * a;
        b >>= 1;
    }
    return res;
}
```

## Հղումներ

- [cp-agorithms "Binary exponentation"](https://cp-algorithms.com/algebra/binary-exp.html)
- [e-maxx "Бинарное возведение в степень"](https://e-maxx.ru/algo/binary_pow)

## Խնդիրներ

_շուտով_